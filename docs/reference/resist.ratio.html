<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate lethal dosage, resistance ratios, and regression coefficients and tests for linearity — resist.ratio • BioRssay</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calculate lethal dosage, resistance ratios, and regression coefficients and tests for linearity — resist.ratio" />
<meta property="og:description" content="Using a generalised linear model (GLM, logit link function), this function computes the lethal doses for 25%, 50% and 95% (unless otherwise provided) of the population (LD25, LD50 and LD95, resp.), and their confidence intervals (LDmax and LDmin, 0.95 by default). See details for more info." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BioRssay</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/BioRssay.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/milesilab/BioRssay/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate lethal dosage, resistance ratios, and regression coefficients and tests for linearity</h1>
    <small class="dont-index">Source: <a href='https://github.com/milesilab/BioRssay/blob/master/R/ratios.R'><code>R/ratios.R</code></a></small>
    <div class="hidden name"><code>resist.ratio.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Using a generalised linear model (GLM, logit link function), this function computes the lethal doses for 25%, 50% and 95% (unless otherwise provided) of the population (LD25, LD50 and LD95, resp.), and their confidence intervals (LDmax and LDmin, 0.95 by default). See details for more info.</p>
    </div>

    <pre class="usage"><span class='fu'>resist.ratio</span><span class='op'>(</span>
  <span class='va'>data</span>,
  conf.level <span class='op'>=</span> <span class='fl'>0.95</span>,
  LD.value <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>, <span class='fl'>50</span>, <span class='fl'>95</span><span class='op'>)</span>,
  ref.strain <span class='op'>=</span> <span class='cn'>NULL</span>,
  plot <span class='op'>=</span> <span class='cn'>FALSE</span>,
  plot.conf <span class='op'>=</span> <span class='cn'>TRUE</span>,
  test.validity <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>a data frame of probit-transformed mortality data using the function probit.trans()</p></td>
    </tr>
    <tr>
      <th>conf.level</th>
      <td><p>numerical. level for confidence intervals to be applied to the models (default 0.95)</p></td>
    </tr>
    <tr>
      <th>LD.value</th>
      <td><p>numerical. Level of lethal dose to be tested. default=c(25,50,95)</p></td>
    </tr>
    <tr>
      <th>ref.strain</th>
      <td><p>character. name of the reference strain if present (see details)</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>logical. Whether to draw the plot. Default FALSE</p></td>
    </tr>
    <tr>
      <th>plot.conf</th>
      <td><p>logical. If plot=TRUE, whether to plot the 95 percent confidence intervals. Default TRUE</p></td>
    </tr>
    <tr>
      <th>test.validity</th>
      <td><p>logical. If plot=TRUE (default), the regression for a strain that failed the linearity test is not plotted</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>parameters to be passed on to graphics for the plot (e.g. col, pch)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a data frame with the various estimates mentioned above. If plot=TRUE, plots the mortality on a probit-transformed scale against the log10 doses.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If a name is provided in ref.strain=, it will be used as the reference to compute the resistance ratios (RR). Alternatively, the function will look for a strain with the suffix "ref" in the dataset. If this returns NULL, the strain with the lowest LD50 will be considered as reference.</p>
<p>In addition to LD values, the function in a nutshell uses a script modified from Johnson et al (2013), which allows taking the g factor into account ("With almost all good sets of data, g will be substantially smaller than 1.0 and seldom greater than 0.4." Finney, 1971) and the heterogeneity (h) of the data (Finney, 1971) to calculate the confidence intervals (i.e. a larger heterogeneity will increase the confidence intervals). It also computes the corresponding resistance ratios (RR), i.e. the ratios between a given strain and the strain with the lower LD50 and LD95, respectively for RR50 and RR95 (usually, it is the susceptible reference strain), with their 95% confidence intervals (RRmin and RRmax), calculated according to Robertson and Preisler (1992). Finally, it also computes the coefficients (slope and intercept, with their standard error) of the linear regressions) and tests for the linearity of the dose-mortality response using a chi-square test (Chi(p)) between the observed dead numbers (data) and the dead numbers predicted by the regression (the test is significant if the data is not linear, e.g. mixed populations).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Finney DJ(1971). Probitanalysis. Cambridge:Cambridge UniversityPress. 350p.</p>
<p>HommelG(1988). A stage wise rejective multiple test procedure based on a modified Bonferroni test. Biometrika 75, 383-6.</p>
<p>Johnson RM, Dahlgren L, Siegfried BD,EllisMD(2013). Acaricide,fungicide and druginteractions in honeybees (Apis mellifera). PLoSONE8(1): e54092.</p>
<p>Robertson, J. L., and H.K. Preisler.1992. Pesticide bioassays with arthropods. CRC, Boca Raton, FL.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Pascal Milesi, Piyal Karunarathne, Pierrick Labbé</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>bioassay</span><span class='op'>)</span>
<span class='va'>transd</span><span class='op'>&lt;-</span><span class='fu'><a href='probit.trans.html'>probit.trans</a></span><span class='op'>(</span><span class='va'>bioassay</span><span class='op'>$</span><span class='va'>assay2</span><span class='op'>)</span>
<span class='va'>data</span><span class='op'>&lt;-</span><span class='va'>transd</span><span class='op'>$</span><span class='va'>tr.data</span>
<span class='fu'>resist.ratio</span><span class='op'>(</span><span class='va'>data</span>,plot<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='resist.ratio-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;           LD25 LD25min LD25max LD25var   LD50 LD50min LD50max LD50var   LD95
#&gt; DZOU    0.0030  0.0024  0.0037       1 0.0074  0.0061  0.0091       1 0.0645
#&gt; DZOU2   0.0025  0.0018  0.0031       1 0.0062  0.0050  0.0077       1 0.0576
#&gt; KIS-ref 0.0009  0.0006  0.0012       1 0.0015  0.0012  0.0018       1 0.0050
#&gt;         LD95min LD95max LD95var Slope SlopeSE Intercept InterceptSE    h      g
#&gt; DZOU     0.0410  0.1252    1.03  1.75  0.1537      3.72      0.3579 1.91 0.0397
#&gt; DZOU2    0.0354  0.1214    1.02  1.69  0.1657      3.74      0.3907 2.33 0.0490
#&gt; KIS-ref  0.0041  0.0067    1.00  3.17  0.3812      8.95      0.9849 3.26 0.0716
#&gt;         Chi(p) rr25 rr25max rr25min rr50 rr50max rr50min rr95 rr95max rr95min
#&gt; DZOU    0.3606 3.24    1931  0.0055 4.84    2877  0.0082   13    7990  0.0207
#&gt; DZOU2   0.3568 2.64    1572  0.0044 4.05    2405  0.0068   11    7090  0.0186
#&gt; KIS-ref 0.5715 1.00     597  0.0017 1.00     594  0.0017    1     596  0.0017</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Piyal Karunarathne, Pascal Milesi, Pierrick Labbé.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


