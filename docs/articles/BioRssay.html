<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="BioRssay">
<title>BioRssay • BioRssay</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="BioRssay">
<meta property="og:description" content="BioRssay">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BioRssay</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/BioRssay.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/milesilab/BioRssay/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>BioRssay</h1>
            
            <h4 data-toc-skip class="date">09 August, 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/milesilab/BioRssay/blob/HEAD/vignettes/BioRssay.Rmd" class="external-link"><code>vignettes/BioRssay.Rmd</code></a></small>
      <div class="d-none name"><code>BioRssay.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://milesilab.github.io/BioRssay/" class="external-link">BioRssay</a></span><span class="op">)</span></code></pre></div>
<div class="section level1">
<h1 id="an-r-package-for-analyses-of-bioassays-and-probit-graphs">
<strong>An R package for analyses of bioassays and probit graphs</strong><a class="anchor" aria-label="anchor" href="#an-r-package-for-analyses-of-bioassays-and-probit-graphs"></a>
</h1>
<p><strong>Piyal Karunarathne, Nicolas Pocquet, Pascal Milesi, and Pierrick Labbé</strong></p>
<p>This package is designed to analyze mortality data from bioassays of one or several strains/lines/populations. As of now, the functions in the package allow adjusting for mortality in the controls with Abott’s correction. For each strain, functions are available to generate a mortality-dose regression using a generalized linear model (which takes over-dispersion into account and allow mortality of 0 or 1), and plot the regressions with or without the desired confidence interval (e.g. 95%).</p>
<p>The package also provides functions to test the linearity of the log-dose response using a chi-square test between model predictions and observed data (significant deviations from linearity may reflect mixed populations for example).</p>
<p>The package also allows determining the lethal doses for 25%, 50% and 95% of the population (LD25, LD50 and LD95 respectively) or the level as specified by the user, with their 95% confidence intervals (CI) and variance of each (e.g., LD25var, LD50var, etc.), following Johnson et al. 2013 approach, which allows taking the heterogeneity of the data into account (<em>Finney 1971</em>) to calculate the CI (i.e. a larger heterogeneity will increase the CI).</p>
<p>The methods implemented here use likelihood ratio tests (LRT) to test for differences in resistance levels among different strains. Finally, resistance ratios (RR) at LD25, LD50 and LD95, i.e. the LD ratios between a given strain and the strain with the lowest LD50 (or LD25,LD50, and LD95; usually it is the susceptible reference), with their 95% confidence intervals are calculated according to Robertson and <em>Preisler (1992)</em>.</p>
<ul>
<li>Installing <code>BioRssay</code>
</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#1. CRAN version</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BioRssay"</span><span class="op">)</span>
<span class="co">#2. Developmental version</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"devtools"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> 
        <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span> 
    <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"milesilab/BioRssay"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="data-preparation">1. <strong>DATA PREPARATION</strong><a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h1>
<p>BioRssay can import data in any format that is compatible with base R data import functions (e.g. read.table, read.csv). However, for the functions in BioRssay to work, the data <strong>must</strong> have at least the following columns (other columns won’t be used, but are no hindrance).</p>
<ul>
<li>strain: a column containing the strains tested</li>
<li>dose: dosage tested on each strain/sample (controls should be entered as 0)</li>
<li>total: total number of samples tested</li>
<li>dead: number of dead (or knock down) samples</li>
</ul>
<p>See the examples below.</p>
<p><strong>Example 1</strong></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bioassay</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bioassay</span><span class="op">$</span><span class="va">assay2</span><span class="op">)</span>
<span class="co">#&gt;   insecticide  strain  dose total dead replicate     date</span>
<span class="co">#&gt; 1    temephos KIS-ref 0.000   100    1         1 26/01/11</span>
<span class="co">#&gt; 2    temephos KIS-ref 0.002    97   47         1 26/01/11</span>
<span class="co">#&gt; 3    temephos KIS-ref 0.003    96   68         1 26/01/11</span>
<span class="co">#&gt; 4    temephos KIS-ref 0.004    98   89         1 26/01/11</span>
<span class="co">#&gt; 5    temephos KIS-ref 0.005    95   90         1 26/01/11</span>
<span class="co">#&gt; 6    temephos KIS-ref 0.007    99   97         1 26/01/11</span></code></pre></div>
<p>Also download the test data at <a href="https://github.com/milesilab/DATA/blob/main/BioAssays/Test.BioRssay.txt" class="external-link uri">https://github.com/milesilab/DATA/blob/main/BioAssays/Test.BioRssay.txt</a> and find more example data sets at <a href="https://github.com/milesilab/DATA/tree/main/BioAssays" class="external-link uri">https://github.com/milesilab/DATA/tree/main/BioAssays</a></p>
<p><strong>Example 2</strong></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">path.package</a></span><span class="op">(</span><span class="st">"BioRssay"</span><span class="op">)</span>, <span class="st">"/Test.BioRssay.txt"</span><span class="op">)</span>
<span class="va">test</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">file</span>,header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span>
<span class="co">#&gt;   insecticide strain dose total dead</span>
<span class="co">#&gt; 1  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 2  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 3  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 4  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 5  bendiocarb Kisumu 0.01    25    0</span>
<span class="co">#&gt; 6  bendiocarb Kisumu 0.01    25    0</span></code></pre></div>
<p>NOTE: It is also possible to include a reference strain/population with the suffix “ref” in the strain column (see example 1), or the reference strain can be specified later in the function <code>resist.ratio</code> to obtain the resistance ratios for each strain (see below).</p>
</div>
<div class="section level1">
<h1 id="analysis">2. <strong>Analysis</strong><a class="anchor" aria-label="anchor" href="#analysis"></a>
</h1>
<p>The workflow is only succinctly described here, for more information on the functions and their options, see individual one in the reference index.</p>
<div class="section level2">
<h2 id="example-1">
<strong>Example 1</strong><a class="anchor" aria-label="anchor" href="#example-1"></a>
</h2>
<p>Let’s have a quick look at the data again.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">assays</span><span class="op">&lt;-</span><span class="va">bioassay</span>
<span class="va">exm1</span><span class="op">&lt;-</span><span class="va">assays</span><span class="op">$</span><span class="va">assay2</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">exm1</span><span class="op">)</span>
<span class="co">#&gt;   insecticide  strain  dose total dead replicate     date</span>
<span class="co">#&gt; 1    temephos KIS-ref 0.000   100    1         1 26/01/11</span>
<span class="co">#&gt; 2    temephos KIS-ref 0.002    97   47         1 26/01/11</span>
<span class="co">#&gt; 3    temephos KIS-ref 0.003    96   68         1 26/01/11</span>
<span class="co">#&gt; 4    temephos KIS-ref 0.004    98   89         1 26/01/11</span>
<span class="co">#&gt; 5    temephos KIS-ref 0.005    95   90         1 26/01/11</span>
<span class="co">#&gt; 6    temephos KIS-ref 0.007    99   97         1 26/01/11</span>
<span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">exm1</span><span class="op">$</span><span class="va">strain</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "KIS-ref" "DZOU"    "DZOU2"</span></code></pre></div>
<p>This example contains the mortality data of three strains (KIS-ref, DZOU, and DZOU2 ); KIS is used as the reference, as indicated by the “ref” suffix.</p>
<p>The first step is to check whether the controls have a non-negligible mortality, in which case a correction should be applied to the data, before probit transformation. This is easily achieved with the function <code><a href="../reference/probit.trans.html">probit.trans()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataT</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/probit.trans.html">probit.trans</a></span><span class="op">(</span><span class="va">exm1</span><span class="op">)</span> <span class="co">#additionally an acceptable threshold for controls' mortality can be set as desired with "conf="; default is 0.05.</span>
<span class="va">dataT</span><span class="op">$</span><span class="va">convrg</span>
<span class="co">#&gt; NULL</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dataT</span><span class="op">$</span><span class="va">tr.data</span><span class="op">)</span>
<span class="co">#&gt;   insecticide  strain  dose total dead replicate     date      mort   probmort</span>
<span class="co">#&gt; 2    temephos KIS-ref 0.002    97   47         1 26/01/11 0.4845361 -0.0387720</span>
<span class="co">#&gt; 3    temephos KIS-ref 0.003    96   68         1 26/01/11 0.7083333  0.5485223</span>
<span class="co">#&gt; 4    temephos KIS-ref 0.004    98   89         1 26/01/11 0.9081633  1.3295291</span>
<span class="co">#&gt; 5    temephos KIS-ref 0.005    95   90         1 26/01/11 0.9473684  1.6198563</span>
<span class="co">#&gt; 6    temephos KIS-ref 0.007    99   97         1 26/01/11 0.9797980  2.0495943</span>
<span class="co">#&gt; 7    temephos KIS-ref 0.010    99   99         1 26/01/11 0.9940000  2.5121443</span></code></pre></div>
<p>The output of probit.trans is a list of which the first element (<code>convrg</code>) contains the results of Abott’s correction and convergence values.</p>
<p>However, since the mortality in the controls (dose=0) is below 5% (<code>conf=0.05</code>) in the present example, <code>data$convrg</code> is NULL and thus no correction is applied to the data . The second element of the list dataT is the probid transformed data with two additional columns: <em>mort</em>, the observed mortalities, and <em>probmort</em>, the observed probit-transformed mortalities. This data frame is what we’ll use in the next steps of the analysis.</p>
<p><em>If you set the threshold to conf=0.01 with example 1, you can assess the effects of the Abbot’s correction: all mortalities are slightly reduced to take the base control mortality into account.</em></p>
<p>The second step is to compute the lethal dose values (25%, 50% and 95%, LD25, LD50 and LD95 respectively) and the corresponding resistance ratios. The function <code>resist.ratio</code> allows you to do just that (user also has the option to calculate these values for different LD values). If no reference strain has been specified in the data file (using the suffix “ref” as mentioned above), it can be specified in <code>ref.strain=</code>. Otherwise, the strain with the lowest LD50 will be considered as such. By default, the LDs’ 95% confidence intervals are computed (the min and max values are reported); you can adjust this using <code>conf.level=</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span><span class="op">&lt;-</span><span class="va">dataT</span><span class="op">$</span><span class="va">tr.data</span> <span class="co">#probid transformed data</span>
<span class="va">RR</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/resist.ratio.html">resist.ratio</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>
<span class="va">RR</span>
<span class="co">#&gt;         Slope SlopeSE Intercept InterceptSE    h      g Chi2 df Chi(p)   LD25</span>
<span class="co">#&gt; DZOU     1.75  0.1537      3.72      0.3579 1.91 0.0397 9.88 10 0.4514 0.0030</span>
<span class="co">#&gt; DZOU2    1.69  0.1657      3.74      0.3907 2.33 0.0490 9.92 10 0.4473 0.0025</span>
<span class="co">#&gt; KIS-ref  3.17  0.3812      8.95      0.9849 3.26 0.0716 8.59 11 0.6597 0.0009</span>
<span class="co">#&gt;         LD25min LD25max   LD50 LD50min LD50max   LD95 LD95min LD95max rr25</span>
<span class="co">#&gt; DZOU      2e-04  0.0192 0.0074   6e-04  0.0404 0.0645  0.0087  0.2472 3.24</span>
<span class="co">#&gt; DZOU2     1e-04  0.0194 0.0062   3e-04  0.0412 0.0576  0.0055  0.2578 2.64</span>
<span class="co">#&gt; KIS-ref   0e+00  0.0142 0.0015   0e+00  0.0209 0.0050  0.0001  0.0537 1.00</span>
<span class="co">#&gt;         rr25min rr25max rr50 rr50min rr50max rr95 rr95min rr95max</span>
<span class="co">#&gt; DZOU     2.7000    3.91 4.84  4.1600    5.64   13  7.6800   22.00</span>
<span class="co">#&gt; DZOU2    2.1900    3.18 4.05  3.5000    4.69   11  7.1100   19.00</span>
<span class="co">#&gt; KIS-ref  0.7947    1.26 1.00  0.8488    1.18    1  0.8085    1.24</span></code></pre></div>
<p>Note that we did not specify the reference strain here as it is already labeled in the data</p>
<p>For each strain, you have first the LD25, LD50 and LD95 and their upper and lower limits (defaults is 95% CI), then the slope and intercept of the regression (with their standard error), the heterogeneity (h) and the g factor (“With almost all good sets of data, g will be substantially smaller than 1.0 and seldom greater than 0.4.” Finney, 1971).</p>
<p>The result of the chi test (<code>Chi(p)</code>) is then indicated to judge whether the data follow a linear regression: here all the p-values are over 0.05 so the fits are acceptable. Finally the resistance ratios are indicated for LD25, LD50 and LD95 (RR25, RR50 and RR95), as well as their upper and lower limits.</p>
<p>The third step, when analyzing more than one strain, is now to test for difference in dose-mortality responses between strains using the <code><a href="../reference/model.signif.html">model.signif()</a></code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/model.signif.html">model.signif</a></span><span class="op">(</span><span class="va">dataT</span><span class="op">$</span><span class="va">tr.data</span><span class="op">)</span>
<span class="co">#&gt; Analysis of Deviance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: mortality ~ log10(data$dose)</span>
<span class="co">#&gt; Model 2: mortality ~ log10(data$dose) * data$strain</span>
<span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    </span>
<span class="co">#&gt; 1        32     936.46                          </span>
<span class="co">#&gt; 2        28      70.69  4   865.77 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; complete model is significant against a NULL model </span>
<span class="co">#&gt;  continueing to pair-wise comparison</span>
<span class="co">#&gt; Output details</span>
<span class="co">#&gt;   model.pval - significance value of ANOVA on the binomial GLM test of the strain pair</span>
<span class="co">#&gt;   bonferroni - significance of the model.pval with bonferroni correction</span>
<span class="co">#&gt;   res.Dv - residual deviance</span>
<span class="co">#&gt;   thr - threshold for the significance of the pvalue</span>
<span class="co">#&gt;   str - values for the strains</span>
<span class="co">#&gt;   int - values for the interaction between the strain and the dose</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $model</span>
<span class="co">#&gt;   strain1 strain2 model.pval bonferroni res.Dv.Null res.Dv.str res.Dv.int</span>
<span class="co">#&gt; 1    DZOU   DZOU2    0.26402    non-sig          NA         NA         NA</span>
<span class="co">#&gt; 2    DZOU KIS-ref          0        sig     1150.41     87.892     49.747</span>
<span class="co">#&gt; 3   DZOU2 KIS-ref          0        sig     1064.79     95.043     53.537</span>
<span class="co">#&gt;   str.pval str.thr int.pval int.thr</span>
<span class="co">#&gt; 1       NA      NA       NA      NA</span>
<span class="co">#&gt; 2        0 0.01250    0.001   0.025</span>
<span class="co">#&gt; 3        0 0.01667    0.001   0.050</span></code></pre></div>
<p>As there are 3 strains, the function first tests whether all strains are similar (i.e. equivalent to 1 strain) or not (i.e. at least one is different from others), using a likelihood ratio test. Here, the test is highly significant, some strains are thus different in terms of dose response.</p>
<p>Pairwise tests are then performed and reported below. Here, the KIS strain is different from DZOU and from DZOU2 strains (model.pval &lt;0.05). DZOU and DZOU2 are not different (model.pval &gt;0.05). The <code>bonferroni</code> column indicates whether the p-values &lt;0.05 remain significant (sig vs non-sig) after correction for multiple testing.</p>
<p>Further, the function outputs seven more columns with statistical outputs from the model evaluation between strains and strain-dose to a null model. The abbreviations are as follows:<br><code>res.Dv</code> - residual deviance<br><code>thr</code> - threshold for the significance of the pvalue<br><code>str</code> - values for the strains<br><code>int</code> - values for the interaction between the strain and the dose</p>
<p><em>Note: the pvalues for strain and strain-dose interaction is from a F-test for a binomial model.</em></p>
<p><strong><em>Data Visualization</em></strong> The data and the regression can be plotted with confidence levels using the <code><a href="../reference/mort.plot.html">mort.plot()</a></code> function. It is also possible to take the validity of the linearity test into account for the plots using the <code>test.validity=</code> option. The probit-transformed mortalities (<code><a href="../reference/probit.trans.html">probit.trans()</a></code> function) are plotted as a function of the log10 of the doses.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">strains</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">strain</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># set plot rows</span>
<span class="co"># plot without confidence intervals and test of validity of the model</span>
<span class="fu"><a href="../reference/mort.plot.html">mort.plot</a></span><span class="op">(</span><span class="va">data</span>,plot.conf<span class="op">=</span><span class="cn">FALSE</span>,test.validity<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> 
<span class="co"># plot only the regression lines</span>
<span class="fu"><a href="../reference/mort.plot.html">mort.plot</a></span><span class="op">(</span><span class="va">data</span>,plot.conf<span class="op">=</span><span class="cn">FALSE</span>,test.validity<span class="op">=</span><span class="cn">FALSE</span>,pch<span class="op">=</span><span class="cn">NA</span><span class="op">)</span> </code></pre></div>
<p><img src="BioRssay_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># same plots with confidence level</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/mort.plot.html">mort.plot</a></span><span class="op">(</span><span class="va">data</span>,plot.conf<span class="op">=</span><span class="cn">TRUE</span>,test.validity<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="../reference/mort.plot.html">mort.plot</a></span><span class="op">(</span><span class="va">data</span>,plot.conf<span class="op">=</span><span class="cn">TRUE</span>,test.validity<span class="op">=</span><span class="cn">FALSE</span>,pch<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></code></pre></div>
<p><img src="BioRssay_files/figure-html/unnamed-chunk-10-2.png" width="768"></p>
<p>It is also possible to plot different confidence intervals with the <code>conf.level=</code> option (the default is 0.95). It is possible to plot only a subset of strains using the <code>strains=</code> option to list the desired strains; if not provided, all the strains will be plotted.</p>
<p>Note that the plots can be generated directly from the “resist.ratio” function using the <code>plot=TRUE</code> option.</p>
</div>
<div class="section level2">
<h2 id="example-2">
<strong>Example 2</strong><a class="anchor" aria-label="anchor" href="#example-2"></a>
</h2>
<p>We follow the same workflow (using the plot option in <code><a href="../reference/resist.ratio.html">resist.ratio()</a></code>). However, there are more than one insecticide tested in this experiment. Therefore, we need to subset the data for each insecticide, and carry out the analysis as before.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span>
<span class="co">#&gt;   insecticide strain dose total dead</span>
<span class="co">#&gt; 1  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 2  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 3  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 4  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 5  bendiocarb Kisumu 0.01    25    0</span>
<span class="co">#&gt; 6  bendiocarb Kisumu 0.01    25    0</span>
<span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">insecticide</span><span class="op">)</span>
<span class="co">#&gt; [1] "bendiocarb"         "chlorpyrifos-metyl" "permethrin"</span>
<span class="va">bend</span><span class="op">&lt;-</span><span class="va">test</span><span class="op">[</span><span class="va">test</span><span class="op">$</span><span class="va">insecticide</span><span class="op">==</span><span class="st">"bendiocarb"</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bend</span><span class="op">)</span>
<span class="co">#&gt;   insecticide strain dose total dead</span>
<span class="co">#&gt; 1  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 2  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 3  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 4  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 5  bendiocarb Kisumu 0.01    25    0</span>
<span class="co">#&gt; 6  bendiocarb Kisumu 0.01    25    0</span></code></pre></div>
<p>We will use a subset of the data for the insecticide “bendiocarb” only.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataT.b</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/probit.trans.html">probit.trans</a></span><span class="op">(</span><span class="va">bend</span><span class="op">)</span>
<span class="va">data.b</span><span class="op">&lt;-</span><span class="va">dataT.b</span><span class="op">$</span><span class="va">tr.data</span>

<span class="va">RR.b</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/resist.ratio.html">resist.ratio</a></span><span class="op">(</span><span class="va">data.b</span>,plot <span class="op">=</span> <span class="cn">T</span>,ref.strain <span class="op">=</span> <span class="st">"Kisumu"</span>,plot.conf <span class="op">=</span> <span class="cn">T</span>, test.validity <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><img src="BioRssay_files/figure-html/unnamed-chunk-13-1.png" width="576"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">RR.b</span><span class="op">)</span>
<span class="co">#&gt;         Slope SlopeSE Intercept InterceptSE    h      g  Chi2 df Chi(p)    LD25</span>
<span class="co">#&gt; Acerkis  5.88  0.3656  -10.2992      0.6734 1.00 0.0149 11.00 31 0.9997 43.0000</span>
<span class="co">#&gt; AgRR5    8.52  0.6962  -16.1686      1.3600 1.61 0.0279 18.00 31 0.9716 66.0000</span>
<span class="co">#&gt; Kisumu   7.69  0.6055    4.3400      0.3282 1.00 0.0238  7.34 39 1.0000  0.2228</span>
<span class="co">#&gt;         LD25min LD25max    LD50 LD50min  LD50max     LD95 LD95min  LD95max rr25</span>
<span class="co">#&gt; Acerkis 18.0000 132.000 57.0000  23.000 178.0000 108.0000 41.0000 371.0000  195</span>
<span class="co">#&gt; AgRR5   19.0000 376.000 79.0000  22.000 468.0000 123.0000 33.0000 798.0000  296</span>
<span class="co">#&gt; Kisumu   0.1355   0.321  0.2726   0.172   0.3824   0.4461  0.3077   0.5862    1</span>
<span class="co">#&gt;          rr25min rr25max rr50  rr50min rr50max rr95 rr95min rr95max</span>
<span class="co">#&gt; Acerkis  86.0000  442.00  207 103.0000   418.0  241 43.0000    1360</span>
<span class="co">#&gt; AgRR5   131.0000  666.00  290 144.0000   583.0  277 49.0000    1560</span>
<span class="co">#&gt; Kisumu    0.3352    2.98    1   0.3849     2.6    1  0.0884      11</span></code></pre></div>
<p>Note that we have enabled the arguments “plot=” with “plot.conf=” and <code>test.validity=</code>. When the log-dose-response is not linear for a strain (Chi-square p-value &lt; 0.05), it will be plotted without forcing linearity as for “Acerkis or AgRR5” strains in this example.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#To then test the difference in dose-mortality response between the strains</span>
<span class="va">t.models</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/model.signif.html">model.signif</a></span><span class="op">(</span><span class="va">data.b</span><span class="op">)</span>
<span class="co">#&gt; Analysis of Deviance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: mortality ~ log10(data$dose)</span>
<span class="co">#&gt; Model 2: mortality ~ log10(data$dose) * data$strain</span>
<span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    </span>
<span class="co">#&gt; 1       102     1981.5                          </span>
<span class="co">#&gt; 2        98      107.8  4   1873.7 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; complete model is significant against a NULL model </span>
<span class="co">#&gt;  continueing to pair-wise comparison</span>
<span class="co">#&gt; Output details</span>
<span class="co">#&gt;   model.pval - significance value of ANOVA on the binomial GLM test of the strain pair</span>
<span class="co">#&gt;   bonferroni - significance of the model.pval with bonferroni correction</span>
<span class="co">#&gt;   res.Dv - residual deviance</span>
<span class="co">#&gt;   thr - threshold for the significance of the pvalue</span>
<span class="co">#&gt;   str - values for the strains</span>
<span class="co">#&gt;   int - values for the interaction between the strain and the dose</span>
<span class="co">#&gt; </span>
<span class="va">t.models</span>
<span class="co">#&gt; $model</span>
<span class="co">#&gt;   strain1 strain2 model.pval bonferroni res.Dv.Null res.Dv.str res.Dv.int</span>
<span class="co">#&gt; 1 Acerkis   AgRR5          0        sig     1437.16     94.149     76.989</span>
<span class="co">#&gt; 2 Acerkis  Kisumu          0        sig     1824.23     66.860     59.425</span>
<span class="co">#&gt; 3   AgRR5  Kisumu          0        sig     1822.46     80.266     79.193</span>
<span class="co">#&gt;   str.pval str.thr int.pval int.thr</span>
<span class="co">#&gt; 1        0 0.00833    0.000 0.01667</span>
<span class="co">#&gt; 2        0 0.01000    0.145 0.02500</span>
<span class="co">#&gt; 3        0 0.01250    0.594 0.05000</span></code></pre></div>
<p>Note that at least one of the strains failed the linearity test, the validity of the pairwise dose-mortality response test is, at best, highly questionable. We do not recommend it.</p>
<p>If many strains are present and only one (few) fails the linearity tests, we do recommend users to remove specific strains from the analyses.</p>
<p>These steps can be repeated for the different insecticides, either one by one or or in a loop (e.g. “for” loop function).</p>
</div>
<div class="section level2">
<h2 id="example-3">
<strong>Example 3</strong><a class="anchor" aria-label="anchor" href="#example-3"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">path.package</a></span><span class="op">(</span><span class="st">"BioRssay"</span><span class="op">)</span>, <span class="st">"/Example3.txt"</span><span class="op">)</span> <span class="co">#import the example file from the package</span>
<span class="va">exm3</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">file</span>,header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">trnd</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/probit.trans.html">probit.trans</a></span><span class="op">(</span><span class="va">exm3</span><span class="op">)</span> <span class="co">#probit transformation and correction of data</span>
<span class="fu"><a href="../reference/resist.ratio.html">resist.ratio</a></span><span class="op">(</span><span class="va">trnd</span><span class="op">$</span><span class="va">tr.data</span>,LD.value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">95</span><span class="op">)</span>,plot <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#get LD and RR values with the mortality plot</span></code></pre></div>
<p><img src="BioRssay_files/figure-html/unnamed-chunk-15-1.png" width="576"></p>
<pre><code><span class="co">#&gt;      Slope SlopeSE Intercept InterceptSE    h      g Chi2 df Chi(p)   LD50</span>
<span class="co">#&gt; DZOU  1.64  0.1857      3.77      0.4515 7.94 0.0579   61 17  0.000 0.0050</span>
<span class="co">#&gt; KIS   3.46  0.2648      9.64      0.7206 3.09 0.0279   14 13  0.358 0.0016</span>
<span class="co">#&gt;      LD50min LD50max   LD95 LD95min LD95max rr50 rr50min rr50max rr95 rr95min</span>
<span class="co">#&gt; DZOU   2e-04  0.0408 0.0504  0.0034  0.2650 3.07  2.7700    3.40   10  7.6200</span>
<span class="co">#&gt; KIS    1e-04  0.0099 0.0048  0.0005  0.0254 1.00  0.8991    1.11    1  0.8157</span>
<span class="co">#&gt;      rr95max</span>
<span class="co">#&gt; DZOU   14.00</span>
<span class="co">#&gt; KIS     1.23</span>
<span class="fu"><a href="../reference/model.signif.html">model.signif</a></span><span class="op">(</span><span class="va">trnd</span><span class="op">$</span><span class="va">tr.data</span><span class="op">)</span> <span class="co"># test the models significance for each strain</span>
<span class="co">#&gt; Output details</span>
<span class="co">#&gt;   model.pval - significance value of ANOVA on the binomial GLM test of the strain pair</span>
<span class="co">#&gt;   bonferroni - significance of the model.pval with bonferroni correction</span>
<span class="co">#&gt;   res.Dv - residual deviance</span>
<span class="co">#&gt;   thr - threshold for the significance of the pvalue</span>
<span class="co">#&gt;   str - values for the strains</span>
<span class="co">#&gt;   int - values for the interaction between the strain and the dose</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $model</span>
<span class="co">#&gt; $model$pairT</span>
<span class="co">#&gt; Analysis of Deviance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: mortality ~ log10(data$dose)</span>
<span class="co">#&gt; Model 2: mortality ~ log10(data$dose) * data$strain</span>
<span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    </span>
<span class="co">#&gt; 1        30     703.60                          </span>
<span class="co">#&gt; 2        28     164.17  2   539.43 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $model$fullM</span>
<span class="co">#&gt;                              Df  Deviance Resid. Df Resid. Dev         F</span>
<span class="co">#&gt; NULL                         NA        NA        31  1839.6531        NA</span>
<span class="co">#&gt; log10(data$dose)              1 1136.0509        30   703.6021 225.62945</span>
<span class="co">#&gt; data$strain                   1  404.0593        29   299.5428  80.24964</span>
<span class="co">#&gt; log10(data$dose):data$strain  1  135.3709        28   164.1719  26.88581</span>
<span class="co">#&gt;                                    Pr(&gt;F)</span>
<span class="co">#&gt; NULL                                   NA</span>
<span class="co">#&gt; log10(data$dose)             6.302655e-15</span>
<span class="co">#&gt; data$strain                  1.029903e-09</span>
<span class="co">#&gt; log10(data$dose):data$strain 1.671886e-05</span></code></pre>
</div>
</div>
<div class="section level1">
<h1 id="references">3. <strong>REFERENCES</strong><a class="anchor" aria-label="anchor" href="#references"></a>
</h1>
<ol style="list-style-type: decimal">
<li><p>Finney DJ(1971). Probitanalysis. Cambridge:Cambridge UniversityPress. 350p.</p></li>
<li><p>HommelG(1988). A stage wise rejective multiple test procedure based on a modified Bonferroni test. Biometrika 75, 383-6.</p></li>
<li><p>Johnson RM, Dahlgren L, Siegfried BD,EllisMD(2013). Acaricide,fungicide and druginteractions in honeybees (Apis mellifera). PLoSONE8(1): e54092.</p></li>
<li><p>Robertson, J. L., and H.K. Preisler.1992. Pesticide bioassays with arthropods. CRC, Boca Raton, FL.</p></li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Piyal Karunarathne, Pascal Milesi, Pierrick Labbé.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
