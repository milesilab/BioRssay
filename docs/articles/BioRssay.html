<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BioRssay • BioRssay</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="BioRssay">
<meta property="og:description" content="BioRssay">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BioRssay</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/BioRssay.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="BioRssay_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>BioRssay</h1>
            
      
      
      <div class="hidden name"><code>BioRssay.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">BioRssay</span><span class="op">)</span></code></pre></div>
<div id="an-r-package-for-analyses-of-bioassays-and-probid-graphs" class="section level1">
<h1 class="hasAnchor">
<a href="#an-r-package-for-analyses-of-bioassays-and-probid-graphs" class="anchor"></a><strong>An R package for analyses of bioassays and probid graphs</strong>
</h1>
<p><em>Piyal Karunarathne, Pascal Milesi, Nicolas Pocquet, and Pierrick Labbé</em></p>
<p>This package is designed to analyze mortality data from bioassays of one or several strains/lines/populations. As of now, the functions in the package allow control mortality with Abott’s correction for more precise analysis of mortality. For each strain, functions are available to generate mortality-dose regression using a generalized linear model (takes over-dispersion into account and allows mortality of 0 or 1), and plot the regressions with or without the desired confidence interval (e.g. 95%).</p>
<p>The package also carries functions to test the validity of the regression outputs using a chi-square test between model predictions and observed number of dead samples; A significant valid test will reflect a non-linear data (e.g. mixed populations). These plots can be drawn side by side for a better comparison with the same functions (see below).</p>
<p>The functions in the package also compute the lethal dose for 50% and 95% of the populations (LD50 and LD95 respectively), with their 95% confidence intervals (CI), using a methodology described by Johnson et al. 2013, which allows taking the heterogeneity of the data into account (Finney 1971) to calculate the CI (i.e. a larger heterogeneity will increase the CI).</p>
<p>The methods implemented use a likelihood ratio test (LRT) to test coherence of mortality-dose regressions among different strains. In the case of more than two strains, a pairwise comparison of models is performed and further corrected using a sequential Bonferroni correction (Hommel 1988). Finally, users can calculate the resistance ratios (RR) at LD50 and LD95, i.e. the ratios between a given strain and the starain with the lower LD50 and LD95, respectively (usually it is the susceptible reference), with their 95% confidence intervals, calculated according to Robertson and Preisler (1992).</p>
</div>
<div id="data-preparation" class="section level1">
<h1 class="hasAnchor">
<a href="#data-preparation" class="anchor"></a>1. <strong>DATA PREPARATION</strong>
</h1>
<p>BioRssay can import data in any format that is compatible with base R data import functions (e.g. read.table, read.csv). However, for the functions in BioRssay to work, the data <strong>must</strong> have the following columns * strain: a column containing the strains tested * dose: dosage tested on each strain/sample. controls should be entered as 0 * total: total number of samples tested * dead: number of dead samples See the examples below.</p>
<p><strong>Example 1</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">bioassay</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bioassay</span><span class="op">$</span><span class="va">assay2</span><span class="op">)</span>
<span class="co">#&gt;   insecticide  strain  dose total dead replicate     date color</span>
<span class="co">#&gt; 1    temephos KIS-ref 0.000   100    1         1 26/01/11     1</span>
<span class="co">#&gt; 2    temephos KIS-ref 0.002    97   47         1 26/01/11     1</span>
<span class="co">#&gt; 3    temephos KIS-ref 0.003    96   68         1 26/01/11     1</span>
<span class="co">#&gt; 4    temephos KIS-ref 0.004    98   89         1 26/01/11     1</span>
<span class="co">#&gt; 5    temephos KIS-ref 0.005    95   90         1 26/01/11     1</span>
<span class="co">#&gt; 6    temephos KIS-ref 0.007    99   97         1 26/01/11     1</span></code></pre></div>
<p>Also download the test data at <a href="https://github.com/milesilab/DATA/blob/main/BioAssays/Test.BioRssay.txt" class="uri">https://github.com/milesilab/DATA/blob/main/BioAssays/Test.BioRssay.txt</a> and find more example data sets at <a href="https://github.com/milesilab/DATA/blob/main/BioAssays" class="uri">https://github.com/milesilab/DATA/blob/main/BioAssays</a></p>
<p><strong>Example 2</strong></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html">path.package</a></span><span class="op">(</span><span class="st">"BioRssay"</span><span class="op">)</span>, <span class="st">"/Test.BioRssay.txt"</span><span class="op">)</span> <span class="co"># if the download doesn't work</span>
<span class="va">test</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="va">file</span>,header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span>
<span class="co">#&gt;   insecticide strain dose total dead</span>
<span class="co">#&gt; 1  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 2  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 3  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 4  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 5  bendiocarb Kisumu 0.01    25    0</span>
<span class="co">#&gt; 6  bendiocarb Kisumu 0.01    25    0</span></code></pre></div>
<p>NOTE: It is also possible to include a reference strain/population with the suffix “ref” in the strain column, or the reference strain can be specified later in the function “resist.ratio” to obtain the resistance ratios for each strain (see below).</p>
</div>
<div id="analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#analysis" class="anchor"></a>2. <strong>Analysis</strong>
</h1>
<div id="example-1" class="section level2">
<h2 class="hasAnchor">
<a href="#example-1" class="anchor"></a><strong>Example 1</strong>
</h2>
<p>Let’s have a quick look at the data again.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">assays</span><span class="op">&lt;-</span><span class="va">bioassay</span>
<span class="va">exm1</span><span class="op">&lt;-</span><span class="va">assays</span><span class="op">$</span><span class="va">assay2</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">exm1</span><span class="op">)</span>
<span class="co">#&gt;   insecticide  strain  dose total dead replicate     date color</span>
<span class="co">#&gt; 1    temephos KIS-ref 0.000   100    1         1 26/01/11     1</span>
<span class="co">#&gt; 2    temephos KIS-ref 0.002    97   47         1 26/01/11     1</span>
<span class="co">#&gt; 3    temephos KIS-ref 0.003    96   68         1 26/01/11     1</span>
<span class="co">#&gt; 4    temephos KIS-ref 0.004    98   89         1 26/01/11     1</span>
<span class="co">#&gt; 5    temephos KIS-ref 0.005    95   90         1 26/01/11     1</span>
<span class="co">#&gt; 6    temephos KIS-ref 0.007    99   97         1 26/01/11     1</span>
<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">exm1</span><span class="op">$</span><span class="va">strain</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "KIS-ref" "DZOU"    "DZOU2"</span></code></pre></div>
<p>This example contains the mortality data of three strains (KIS, DZOU, and KIS-ref); KIS is used as the reference with suffix “ref”.</p>
<p>The first step is to check if the controls also have considerable mortality and whether a correction should be applied to the data, followed by probid transformation (<em>we might need to explain more on why this transformation</em>). This is easily achieved with the function “probit.trans”.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataT</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/probid.trans.html">probid.trans</a></span><span class="op">(</span><span class="va">exm1</span><span class="op">)</span> <span class="co">#additionally confindence interval for controls' mortality can be set as desired with "conf="; default is 0.05.</span>
<span class="va">dataT</span><span class="op">$</span><span class="va">convrg</span>
<span class="co">#&gt; NULL</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dataT</span><span class="op">$</span><span class="va">tr.data</span><span class="op">)</span>
<span class="co">#&gt;   insecticide  strain  dose total dead replicate     date color      mort</span>
<span class="co">#&gt; 2    temephos KIS-ref 0.002    97   47         1 26/01/11     1 0.4845361</span>
<span class="co">#&gt; 3    temephos KIS-ref 0.003    96   68         1 26/01/11     1 0.7083333</span>
<span class="co">#&gt; 4    temephos KIS-ref 0.004    98   89         1 26/01/11     1 0.9081633</span>
<span class="co">#&gt; 5    temephos KIS-ref 0.005    95   90         1 26/01/11     1 0.9473684</span>
<span class="co">#&gt; 6    temephos KIS-ref 0.007    99   97         1 26/01/11     1 0.9797980</span>
<span class="co">#&gt; 7    temephos KIS-ref 0.010    99   99         1 26/01/11     1 0.9940000</span>
<span class="co">#&gt;     probmort</span>
<span class="co">#&gt; 2 -0.0387720</span>
<span class="co">#&gt; 3  0.5485223</span>
<span class="co">#&gt; 4  1.3295291</span>
<span class="co">#&gt; 5  1.6198563</span>
<span class="co">#&gt; 6  2.0495943</span>
<span class="co">#&gt; 7  2.5121443</span></code></pre></div>
<p>The output of probid.trans is a list of which the first element (convrg) contains the results of Abotte’s correction and convergence values. However, since the mortality in the controls (dose=0) is below 5% (alpha=0.05), no correction applied to the data. Hence data$convrg is NULL. The second element of the list dataT is the probid transformed data with two additional columns: mort: mortality and probmort: probid transformed mortality. This data frame is what we’ll use in the next steps of the analysis.</p>
<p>Next we will get the LD values at (50% and 95%) and resistance ratios at their respective LD values. The function “resist.ratio” allows you to do just that. Here you can also change the confidence level at which the LD is tested (default is 0.95); the reference strain can be specified in “ref.strain=”, if labeled with the suffix “ref” (as mentioned above), it is not necessary to specify it here although doing so still works. However, if the strain is not labeled with the said suffix in the data, ref.strain <strong>must</strong> be specified here. If neither labeled with “ref” nor specified with “ref.strain=”, the analysis will not consider any references.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span><span class="op">&lt;-</span><span class="va">dataT</span><span class="op">$</span><span class="va">tr.data</span> <span class="co">#probid transformed data</span>
<span class="va">RR</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/resist.ratio.html">resist.ratio</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>
<span class="va">RR</span>
<span class="co">#&gt;                LD50     LD50min     LD50max      varLD50        LD95    LD95min</span>
<span class="co">#&gt; DZOU    0.007360928 0.006136601 0.009107134 0.0004813749 0.064493518 0.04099287</span>
<span class="co">#&gt; DZOU2   0.006156279 0.005043721 0.007720790 0.0003991162 0.057611139 0.03537616</span>
<span class="co">#&gt; KIS-ref 0.001519579 0.001163367 0.001819190 0.0006597966 0.005011012 0.00414955</span>
<span class="co">#&gt;             LD95max     varLD95    Slope   SlopeSE Intercept InterceptSE</span>
<span class="co">#&gt; DZOU    0.125240023 0.012002361 1.745048 0.1537397  3.722305   0.3579163</span>
<span class="co">#&gt; DZOU2   0.121382718 0.010222512 1.693651 0.1657277  3.744123   0.3906964</span>
<span class="co">#&gt; KIS-ref 0.006666735 0.001109805 3.174155 0.3811593  8.945646   0.9848957</span>
<span class="co">#&gt;                h          g    Chi(p)     rr50  rr50max  rr50min     rr95</span>
<span class="co">#&gt; DZOU    1.905596 0.03971941 0.3606160 4.844057 5.641835 4.159087 12.87036</span>
<span class="co">#&gt; DZOU2   2.326646 0.04899907 0.3568112 4.051305 4.692185 3.497959 11.49691</span>
<span class="co">#&gt; KIS-ref 3.259672 0.07158818 0.5714766 1.000000 0.000000 0.000000  1.00000</span>
<span class="co">#&gt;          rr95max   rr95min</span>
<span class="co">#&gt; DZOU    14.99001 11.050435</span>
<span class="co">#&gt; DZOU2   13.31562  9.926605</span>
<span class="co">#&gt; KIS-ref  0.00000  0.000000</span></code></pre></div>
<p><em>Note that we did not specify the reference strain here as it is already labeled in the data</em></p>
<p><em>For each strain you have first the LD50 and LD95 and their upper and lower limits (95% CI), then the slope and intercept of the regression (with their standard error), the heterogeneity (h) and the g factor (“With almost all good sets of data, g will be substantially smaller than 1.0 and seldom greater than 0.4.” Finney, 1971). </em>The result of the chi test (Chi(p)) is then indicated to judge whether the data are well fitted to the regression or not: here all the p-values are over 0.05 so the fits are acceptable). <em>Finally the resistance ratios are indicated for LD50 and LD95 (RR50 and RR95). </em>As there are 3 strains, the script first tests whether they are all similar (i.e. equivalent to 1 strain) or not (3 strains vs 1 strain). Here, the test is highly significant, some strains are thus different in terms of resistance.</p>
<p>Plotting option with confidence levels and a validity test of the regression models is also available in the function “resist.ratio”. However, we did not use it here and we will do a more comparative plotting with “mort.plot” next.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#strains&lt;-levels(data$strain)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># set plot rows</span>
<span class="fu"><a href="../reference/mort.plot.html">mort.plot</a></span><span class="op">(</span><span class="va">data</span>,plot.conf<span class="op">=</span><span class="cn">FALSE</span>,test.validity<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># plot without confidence intervals and test of validity of the model</span>
<span class="fu"><a href="../reference/mort.plot.html">mort.plot</a></span><span class="op">(</span><span class="va">data</span>,plot.conf<span class="op">=</span><span class="cn">FALSE</span>,test.validity<span class="op">=</span><span class="cn">FALSE</span>,pch<span class="op">=</span><span class="cn">NA</span><span class="op">)</span> <span class="co"># plot only the regression lines</span></code></pre></div>
<p><img src="BioRssay_files/figure-html/unnamed-chunk-7-1.png" width="768"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># same plots with confidence level</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/mort.plot.html">mort.plot</a></span><span class="op">(</span><span class="va">data</span>,plot.conf<span class="op">=</span><span class="cn">TRUE</span>,test.validity<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="../reference/mort.plot.html">mort.plot</a></span><span class="op">(</span><span class="va">data</span>,plot.conf<span class="op">=</span><span class="cn">TRUE</span>,test.validity<span class="op">=</span><span class="cn">FALSE</span>,pch<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></code></pre></div>
<p><img src="BioRssay_files/figure-html/unnamed-chunk-7-2.png" width="768"> It is also possible to input different confidence levels with “conf.level=”. The default is 0.95. In cases where only a subset of all the tested strains needs to be tested, they can be listed with “strains=”; if not provided, all the strains will be plotted.</p>
</div>
<div id="example-2" class="section level2">
<h2 class="hasAnchor">
<a href="#example-2" class="anchor"></a><strong>Example 2</strong>
</h2>
<p>We follow the same workflow the example 2. However, there are more than one insecticide tested in this experiment. Therefore, we need to subset the data into separate insecticides and carry out the analysis as before.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span>
<span class="co">#&gt;   insecticide strain dose total dead</span>
<span class="co">#&gt; 1  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 2  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 3  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 4  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 5  bendiocarb Kisumu 0.01    25    0</span>
<span class="co">#&gt; 6  bendiocarb Kisumu 0.01    25    0</span>
<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">insecticide</span><span class="op">)</span>
<span class="co">#&gt; [1] "bendiocarb"         "chlorpyrifos-metyl" "permethrin"</span>
<span class="va">bend</span><span class="op">&lt;-</span><span class="va">test</span><span class="op">[</span><span class="va">test</span><span class="op">$</span><span class="va">insecticide</span><span class="op">==</span><span class="st">"bendiocarb"</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bend</span><span class="op">)</span>
<span class="co">#&gt;   insecticide strain dose total dead</span>
<span class="co">#&gt; 1  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 2  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 3  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 4  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 5  bendiocarb Kisumu 0.01    25    0</span>
<span class="co">#&gt; 6  bendiocarb Kisumu 0.01    25    0</span></code></pre></div>
<p>We have a subset of the data with only the insecticide “bendiocarb”</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataT.b</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/probid.trans.html">probid.trans</a></span><span class="op">(</span><span class="va">bend</span><span class="op">)</span>
<span class="va">data.b</span><span class="op">&lt;-</span><span class="va">dataT.b</span><span class="op">$</span><span class="va">tr.data</span>

<span class="va">RR.b</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/resist.ratio.html">resist.ratio</a></span><span class="op">(</span><span class="va">data.b</span>,plot <span class="op">=</span> <span class="cn">T</span>,ref.strain <span class="op">=</span> <span class="st">"Kisumu"</span>,plot.conf <span class="op">=</span> <span class="cn">T</span>, test.validity <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><img src="BioRssay_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">RR.b</span><span class="op">)</span>
<span class="co">#&gt;               LD50    LD50min    LD50max     varLD50       LD95    LD95min</span>
<span class="co">#&gt; Acerkis 56.5098989 53.2114813 59.6792554 0.001786642 107.634086 100.302691</span>
<span class="co">#&gt; AgRR5   79.1108266 74.7149834 83.1800402 0.001573892 123.408708 115.649404</span>
<span class="co">#&gt; Kisumu   0.2726414  0.2587263  0.2860428 0.022377514   0.446101   0.415979</span>
<span class="co">#&gt;             LD95max     varLD95    Slope   SlopeSE  Intercept InterceptSE</span>
<span class="co">#&gt; Acerkis 117.1146160 0.002410525 5.878145 0.3656493 -10.299242   0.6734320</span>
<span class="co">#&gt; AgRR5   134.1446941 0.002449533 8.517708 0.6962015 -16.168620   1.3613946</span>
<span class="co">#&gt; Kisumu    0.4878805 0.144419248 7.691933 0.6055473   4.341389   0.3281966</span>
<span class="co">#&gt;                h          g       Chi(p)     rr50  rr50max  rr50min     rr95</span>
<span class="co">#&gt; Acerkis 1.000000 0.01486432 9.995387e-01 207.2682 418.0336 102.7671 241.2774</span>
<span class="co">#&gt; AgRR5   1.612638 0.02786453 9.609371e-01 290.1644 583.4161 144.3144 276.6385</span>
<span class="co">#&gt; Kisumu  1.000000 0.02380791 7.672306e-24   1.0000   0.0000   0.0000   1.0000</span>
<span class="co">#&gt;          rr95max  rr95min</span>
<span class="co">#&gt; Acerkis 486.6258 119.6294</span>
<span class="co">#&gt; AgRR5   556.2204 137.5873</span>
<span class="co">#&gt; Kisumu    0.0000   0.0000</span></code></pre></div>
<p>Note that we have enabled the arguments “plot=” with “plot.conf=” and “test.validity=”. When the regression is not valid (Chi-square significance) for a strain, it will be plotted without the regression, as in this example “Kisumu”.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#test the validity of the regression models</span>
<span class="va">t.models</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/model.signif.html">model.signif</a></span><span class="op">(</span><span class="va">data.b</span><span class="op">)</span>
<span class="va">t.models</span>
<span class="co">#&gt; $model</span>
<span class="co">#&gt;   strain1 strain2           model.pval          deviance df bonferroni</span>
<span class="co">#&gt; 1 Acerkis   AgRR5 9.81944629906017e-18 -93.3705086548187 -2        sig</span>
<span class="co">#&gt; 2 Acerkis  Kisumu 4.09605796743876e-78 -1220.98742604214 -2        sig</span>
<span class="co">#&gt; 3   AgRR5  Kisumu 3.52611879574658e-84 -1433.09904360371 -2        sig</span></code></pre></div>
<p>These steps can be repeated for separate insecticides in the example 2 one by one or in a loop (e.g. for loop)</p>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>3. <strong>REFERENCES</strong>
</h1>
<ol style="list-style-type: decimal">
<li><p>Finney DJ(1971). Probitanalysis. Cambridge:Cambridge UniversityPress. 350p.</p></li>
<li><p>HommelG(1988). A stage wise rejective multiple test procedure based on a modified Bonferroni test. Biometrika 75, 383-6.</p></li>
<li><p>Johnson RM, Dahlgren L, Siegfried BD,EllisMD(2013). Acaricide,fungicide and druginteractions in honeybees (Apis mellifera). PLoSONE8(1): e54092.</p></li>
<li><p>Robertson, J. L., and H.K. Preisler.1992. Pesticide bioassays with arthropods. CRC, Boca Raton, FL.</p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Piyal Karunarathne, Pascal Milesi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
