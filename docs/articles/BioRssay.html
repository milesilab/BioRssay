<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BioRssay • BioRssay</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="BioRssay">
<meta property="og:description" content="BioRssay">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BioRssay</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/BioRssay.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="BioRssay_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>BioRssay</h1>
            
      
      
      <div class="hidden name"><code>BioRssay.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">BioRssay</span><span class="op">)</span></code></pre></div>
<div id="an-r-package-for-analyses-of-bioassays-and-probit-graphs" class="section level1">
<h1 class="hasAnchor">
<a href="#an-r-package-for-analyses-of-bioassays-and-probit-graphs" class="anchor"></a><strong>An R package for analyses of bioassays and probit graphs</strong>
</h1>
<p><em>Piyal Karunarathne, Nicolas Pocquet, Pascal Milesi, and Pierrick Labbé</em></p>
<p>This package is designed to analyze mortality data from bioassays of one or several strains/lines/populations. As of now, the functions in the package allow adjusting for mortality in the controls with Abott’s correction. For each strain, functions are available to generate a mortality-dose regression using a generalized linear model (which take over-dispersion into account and allow mortality of 0 or 1), and plot the regressions with or without the desired confidence interval (e.g. 95%).</p>
<p>The package also provides functions to test the linearity of the log-dose response using a chi-square test between model predictions and observed data (significant deviations from linearity may reflect mixed populations for example).</p>
<p>The package also allows computing the lethal dose for 50% and 95% of the populations (LD50 and LD95 respectively), with their 95% confidence intervals (CI), following Johnson et al. 2013 approach, which allows taking the heterogeneity of the data into account (<em>Finney 1971</em>) to calculate the CI (i.e. a larger heterogeneity will increase the CI).</p>
<p>The methods implemented here use a likelihood ratio test (LRT) to test for differences in resistance levels among different strains. Finally, resistance ratios (RR) at LD50 and LD95, i.e. the ratios between a given strain and the strain with the lower LD50 and LD95, respectively (usually it is the susceptible reference), with their 95% confidence intervals, are calculated according to Robertson and <em>Preisler (1992)</em>.</p>
</div>
<div id="data-preparation" class="section level1">
<h1 class="hasAnchor">
<a href="#data-preparation" class="anchor"></a>1. <strong>DATA PREPARATION</strong>
</h1>
<p>BioRssay can import data in any format that is compatible with base R data import functions (e.g. read.table, read.csv). However, for the functions in BioRssay to work, the data <strong>must</strong> have at least the following columns (other columns won’t be used, but are no hindrance): * strain: a column containing the strains tested * dose: dosage tested on each strain/sample. controls should be entered as 0 * total: total number of samples tested * dead: number of dead samples See the examples below.</p>
<p><strong>Example 1</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">bioassay</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bioassay</span><span class="op">$</span><span class="va">assay2</span><span class="op">)</span>
<span class="co">#&gt;   insecticide  strain  dose total dead replicate     date</span>
<span class="co">#&gt; 1    temephos KIS-ref 0.000   100    1         1 26/01/11</span>
<span class="co">#&gt; 2    temephos KIS-ref 0.002    97   47         1 26/01/11</span>
<span class="co">#&gt; 3    temephos KIS-ref 0.003    96   68         1 26/01/11</span>
<span class="co">#&gt; 4    temephos KIS-ref 0.004    98   89         1 26/01/11</span>
<span class="co">#&gt; 5    temephos KIS-ref 0.005    95   90         1 26/01/11</span>
<span class="co">#&gt; 6    temephos KIS-ref 0.007    99   97         1 26/01/11</span></code></pre></div>
<p>Also download the test data at <a href="https://github.com/milesilab/DATA/blob/main/BioAssays/Test.BioRssay.txt" class="uri">https://github.com/milesilab/DATA/blob/main/BioAssays/Test.BioRssay.txt</a> and find more example data sets at <a href="https://github.com/milesilab/DATA/blob/main/BioAssays" class="uri">https://github.com/milesilab/DATA/blob/main/BioAssays</a></p>
<p><strong>Example 2</strong></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html">path.package</a></span><span class="op">(</span><span class="st">"BioRssay"</span><span class="op">)</span>, <span class="st">"/Test.BioRssay.txt"</span><span class="op">)</span>
<span class="va">test</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="va">file</span>,header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span>
<span class="co">#&gt;   insecticide strain dose total dead</span>
<span class="co">#&gt; 1  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 2  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 3  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 4  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 5  bendiocarb Kisumu 0.01    25    0</span>
<span class="co">#&gt; 6  bendiocarb Kisumu 0.01    25    0</span></code></pre></div>
<p>NOTE: It is also possible to include a reference strain/population with the suffix “ref” in the strain column, or the reference strain can be specified later in the function “resist.ratio” to obtain the resistance ratios for each strain (see below).</p>
</div>
<div id="analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#analysis" class="anchor"></a>2. <strong>Analysis</strong>
</h1>
<p>The workflow is only succinctly described here, for more information on the functions and their options, see individual one in the reference index.</p>
<div id="example-1" class="section level2">
<h2 class="hasAnchor">
<a href="#example-1" class="anchor"></a><strong>Example 1</strong>
</h2>
<p>Let’s have a quick look at the data again.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">assays</span><span class="op">&lt;-</span><span class="va">bioassay</span>
<span class="va">exm1</span><span class="op">&lt;-</span><span class="va">assays</span><span class="op">$</span><span class="va">assay2</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">exm1</span><span class="op">)</span>
<span class="co">#&gt;   insecticide  strain  dose total dead replicate     date</span>
<span class="co">#&gt; 1    temephos KIS-ref 0.000   100    1         1 26/01/11</span>
<span class="co">#&gt; 2    temephos KIS-ref 0.002    97   47         1 26/01/11</span>
<span class="co">#&gt; 3    temephos KIS-ref 0.003    96   68         1 26/01/11</span>
<span class="co">#&gt; 4    temephos KIS-ref 0.004    98   89         1 26/01/11</span>
<span class="co">#&gt; 5    temephos KIS-ref 0.005    95   90         1 26/01/11</span>
<span class="co">#&gt; 6    temephos KIS-ref 0.007    99   97         1 26/01/11</span>
<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">exm1</span><span class="op">$</span><span class="va">strain</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "KIS-ref" "DZOU"    "DZOU2"</span></code></pre></div>
<p>This example contains the mortality data of three strains (KIS, DZOU, and KIS-ref); KIS is used as the reference, as indicated by the “ref” suffix.</p>
<p>The first step is to check whether the controls have a non-negligible mortality, in which case a correction should be applied to the data, before probit transformation. This is easily achieved with the function “probit.trans”.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataT</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/probit.trans.html">probit.trans</a></span><span class="op">(</span><span class="va">exm1</span><span class="op">)</span> <span class="co">#additionally an acceptable threshold for controls' mortality can be set as desired with "conf="; default is 0.05.</span>
<span class="va">dataT</span><span class="op">$</span><span class="va">convrg</span>
<span class="co">#&gt; NULL</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dataT</span><span class="op">$</span><span class="va">tr.data</span><span class="op">)</span>
<span class="co">#&gt;   insecticide  strain  dose total dead replicate     date      mort   probmort</span>
<span class="co">#&gt; 2    temephos KIS-ref 0.002    97   47         1 26/01/11 0.4845361 -0.0387720</span>
<span class="co">#&gt; 3    temephos KIS-ref 0.003    96   68         1 26/01/11 0.7083333  0.5485223</span>
<span class="co">#&gt; 4    temephos KIS-ref 0.004    98   89         1 26/01/11 0.9081633  1.3295291</span>
<span class="co">#&gt; 5    temephos KIS-ref 0.005    95   90         1 26/01/11 0.9473684  1.6198563</span>
<span class="co">#&gt; 6    temephos KIS-ref 0.007    99   97         1 26/01/11 0.9797980  2.0495943</span>
<span class="co">#&gt; 7    temephos KIS-ref 0.010    99   99         1 26/01/11 0.9940000  2.5121443</span></code></pre></div>
<p>The output of probit.trans is a list of which the first element (convrg) contains the results of Abott’s correction and convergence values.</p>
<p>However, since the mortality in the controls (dose=0) is below 5% (conf=0.05) in the present example, data$convrg is NULL and thus no correction is applied to the data . The second element of the list dataT is the probid transformed data with two additional columns: mort, the observed mortalities, and probmort, the observed probit-transformed mortalities. This data frame is what we’ll use in the next steps of the analysis.</p>
<p><em>If you set the threshold to conf=0.01 with example 1, you can assess the effects of the Abbot’s correction: all mortalities are slightly reduced to take the base control mortality into account.</em></p>
<p>The second step is to compute the lethal dose values (50% and 95%, LD50 and LD95 respectively) and the corresponding resistance ratios. The function “resist.ratio” allows you to do just that. If no reference strain has been specified in the data file (using the suffix “ref” as mentioned above), it can be specified in “ref.strain=”. Otherwise, the strain with the lowest LD50 will be considered as such. By default, the LDs’ 95% confidence intervals are computed (the min and max values are reported); you can adjust this using “conf.level=”.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span><span class="op">&lt;-</span><span class="va">dataT</span><span class="op">$</span><span class="va">tr.data</span> <span class="co">#probid transformed data</span>
<span class="va">RR</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/resist.ratio.html">resist.ratio</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>
<span class="va">RR</span>
<span class="co">#&gt;           LD25 LD25min LD25max LD25var   LD50 LD50min LD50max LD50var   LD95</span>
<span class="co">#&gt; DZOU    0.0030  0.0024  0.0037       1 0.0074  0.0061  0.0091       1 0.0645</span>
<span class="co">#&gt; DZOU2   0.0025  0.0018  0.0031       1 0.0062  0.0050  0.0077       1 0.0576</span>
<span class="co">#&gt; KIS-ref 0.0009  0.0006  0.0012       1 0.0015  0.0012  0.0018       1 0.0050</span>
<span class="co">#&gt;         LD95min LD95max LD95var Slope SlopeSE Intercept InterceptSE    h      g</span>
<span class="co">#&gt; DZOU     0.0410  0.1252    1.03  1.75  0.1537      3.72      0.3579 1.91 0.0397</span>
<span class="co">#&gt; DZOU2    0.0354  0.1214    1.02  1.69  0.1657      3.74      0.3907 2.33 0.0490</span>
<span class="co">#&gt; KIS-ref  0.0041  0.0067    1.00  3.17  0.3812      8.95      0.9849 3.26 0.0716</span>
<span class="co">#&gt;         Chi(p) rr25 rr25max rr25min rr50 rr50max rr50min rr95 rr95max rr95min</span>
<span class="co">#&gt; DZOU    0.3606 3.24    1931  0.0055 4.84    2877  0.0082   13    7990  0.0207</span>
<span class="co">#&gt; DZOU2   0.3568 2.64    1572  0.0044 4.05    2405  0.0068   11    7090  0.0186</span>
<span class="co">#&gt; KIS-ref 0.5715 1.00     597  0.0017 1.00     594  0.0017    1     596  0.0017</span></code></pre></div>
<p><em>Note that we did not specify the reference strain here as it is already labeled in the data</em></p>
<p><em>For each strain, you have first the LD50 and LD95 and their upper and lower limits (defaults is 95% CI), then the slope and intercept of the regression (with their standard error), the heterogeneity (h) and the g factor (“With almost all good sets of data, g will be substantially smaller than 1.0 and seldom greater than 0.4.” Finney, 1971).</em></p>
<p><em>The result of the chi test (Chi(p)) is then indicated to judge whether the data follow a linear regression: here all the p-values are over 0.05 so the fits are acceptable. Finally the resistance ratios are indicated for LD50 and LD95 (RR50 and RR95), as well as their upper and lower limits.</em></p>
<p><em>The third step, when analysing more than one strain, is now to test for difference in dose-mortality responses between strains using the “model.signif” function.</em></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/model.signif.html">model.signif</a></span><span class="op">(</span><span class="va">dataT</span><span class="op">$</span><span class="va">tr.data</span><span class="op">)</span>
<span class="co">#&gt; $model</span>
<span class="co">#&gt;   strain1 strain2           model.pval          deviance df bonferroni</span>
<span class="co">#&gt; 1    DZOU   DZOU2    0.264023226942502 -5.52847606655654 -2        sig</span>
<span class="co">#&gt; 2    DZOU KIS-ref  8.3588934657195e-61 -714.373451385791 -2        sig</span>
<span class="co">#&gt; 3   DZOU2 KIS-ref 3.15241148845391e-48 -603.931258358858 -2    non-sig</span></code></pre></div>
<p><em>As there are 3 strains, the function first tests whether all strains are similar (i.e. equivalent to 1 strain) or not (3 strains vs 1 strain), using a likelihood ratio test. Here, the test is highly significant, some strains are thus different in terms of resistance.</em></p>
<p><em>Pairwise tests are then performed and reported below. Here, the KIS strain is different from DZOU and from DZOU2 strains (model.pval &lt;0.05). DZOU and DZOU2 are not different (model.pval &gt;0.05). The bonferroni column indicates whether the p-values &lt;0.05 remain significant (sig vs non-sig) after correction for multiple testing.</em></p>
<p><strong><em>Data Visualization</em></strong> The data and the regression can be plotted with confidence levels using the “mort.plot” function. It is also possible to take the validity of the linearity test into account for the plots using the “test.validity=” option. The probit-transformed mortalities [probit.trans() function] are plotted as a function of the log10 of the doses.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#strains&lt;-levels(data$strain)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># set plot rows</span>
<span class="fu"><a href="../reference/mort.plot.html">mort.plot</a></span><span class="op">(</span><span class="va">data</span>,plot.conf<span class="op">=</span><span class="cn">FALSE</span>,test.validity<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># plot without confidence intervals and test of validity of the model</span>
<span class="fu"><a href="../reference/mort.plot.html">mort.plot</a></span><span class="op">(</span><span class="va">data</span>,plot.conf<span class="op">=</span><span class="cn">FALSE</span>,test.validity<span class="op">=</span><span class="cn">FALSE</span>,pch<span class="op">=</span><span class="cn">NA</span><span class="op">)</span> <span class="co"># plot only the regression lines</span></code></pre></div>
<p><img src="BioRssay_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># same plots with confidence level</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/mort.plot.html">mort.plot</a></span><span class="op">(</span><span class="va">data</span>,plot.conf<span class="op">=</span><span class="cn">TRUE</span>,test.validity<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="../reference/mort.plot.html">mort.plot</a></span><span class="op">(</span><span class="va">data</span>,plot.conf<span class="op">=</span><span class="cn">TRUE</span>,test.validity<span class="op">=</span><span class="cn">FALSE</span>,pch<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></code></pre></div>
<p><img src="BioRssay_files/figure-html/unnamed-chunk-8-2.png" width="768"> It is also possible to plot different confidence intervals with the “conf.level=” option (the default is 0.95). It is possible to plot only a subset of strains using the “strains=” option to list the desired strains; if not provided, all the strains will be plotted.</p>
<p><em>Note that the plots can be generated directly from the “resist.ratio” function using the “plot=T” option.</em></p>
</div>
<div id="example-2" class="section level2">
<h2 class="hasAnchor">
<a href="#example-2" class="anchor"></a><strong>Example 2</strong>
</h2>
<p>We follow the same workflow (using the plot option in “resist.ratio”). However, there are more than one insecticide tested in this experiment. Therefore, we need to subset the data for each insecticide, and carry out the analysis as before.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span>
<span class="co">#&gt;   insecticide strain dose total dead</span>
<span class="co">#&gt; 1  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 2  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 3  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 4  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 5  bendiocarb Kisumu 0.01    25    0</span>
<span class="co">#&gt; 6  bendiocarb Kisumu 0.01    25    0</span>
<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">insecticide</span><span class="op">)</span>
<span class="co">#&gt; [1] "bendiocarb"         "chlorpyrifos-metyl" "permethrin"</span>
<span class="va">bend</span><span class="op">&lt;-</span><span class="va">test</span><span class="op">[</span><span class="va">test</span><span class="op">$</span><span class="va">insecticide</span><span class="op">==</span><span class="st">"bendiocarb"</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bend</span><span class="op">)</span>
<span class="co">#&gt;   insecticide strain dose total dead</span>
<span class="co">#&gt; 1  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 2  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 3  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 4  bendiocarb Kisumu 0.00    25    0</span>
<span class="co">#&gt; 5  bendiocarb Kisumu 0.01    25    0</span>
<span class="co">#&gt; 6  bendiocarb Kisumu 0.01    25    0</span></code></pre></div>
<p>We will use a subset of the data for the insecticide “bendiocarb” only.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataT.b</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/probit.trans.html">probit.trans</a></span><span class="op">(</span><span class="va">bend</span><span class="op">)</span>
<span class="va">data.b</span><span class="op">&lt;-</span><span class="va">dataT.b</span><span class="op">$</span><span class="va">tr.data</span>

<span class="va">RR.b</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/resist.ratio.html">resist.ratio</a></span><span class="op">(</span><span class="va">data.b</span>,plot <span class="op">=</span> <span class="cn">T</span>,ref.strain <span class="op">=</span> <span class="st">"Kisumu"</span>,plot.conf <span class="op">=</span> <span class="cn">T</span>, test.validity <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><img src="BioRssay_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">RR.b</span><span class="op">)</span>
<span class="co">#&gt;            LD25 LD25min LD25max LD25var    LD50 LD50min LD50max LD50var</span>
<span class="co">#&gt; Acerkis 43.0000 40.0000 47.0000    1.01 57.0000 53.0000  60.000    1.00</span>
<span class="co">#&gt; AgRR5   66.0000 61.0000 70.0000    1.01 79.0000 75.0000  83.000    1.00</span>
<span class="co">#&gt; Kisumu   0.2228  0.2069  0.2365    1.07  0.2726  0.2587   0.286    1.05</span>
<span class="co">#&gt;             LD95 LD95min  LD95max LD95var Slope SlopeSE Intercept InterceptSE</span>
<span class="co">#&gt; Acerkis 108.0000 100.000 117.0000    1.01  5.88  0.3656  -10.2992      0.6734</span>
<span class="co">#&gt; AgRR5   123.0000 116.000 134.0000    1.01  8.52  0.6962  -16.1686      1.3600</span>
<span class="co">#&gt; Kisumu    0.4461   0.416   0.4879    1.39  7.69  0.6055    4.3400      0.3282</span>
<span class="co">#&gt;            h      g Chi(p) rr25 rr25max rr25min rr50 rr50max rr50min rr95</span>
<span class="co">#&gt; Acerkis 1.00 0.0149 0.9995  195  130322  0.2910  207  134157  0.3202  241</span>
<span class="co">#&gt; AgRR5   1.61 0.0279 0.9609  296  197599  0.4431  290  187667  0.4486  277</span>
<span class="co">#&gt; Kisumu  1.00 0.0238 0.0000    1     736  0.0014    1     699  0.0014    1</span>
<span class="co">#&gt;         rr95max rr95min</span>
<span class="co">#&gt; Acerkis  262409  0.2218</span>
<span class="co">#&gt; AgRR5    300907  0.2543</span>
<span class="co">#&gt; Kisumu     1876  0.0005</span></code></pre></div>
<p><em>Note that we have enabled the arguments “plot=” with “plot.conf=” and “test.validity=”. When the log-dose-response is not linear for a strain (Chi-square p-value &lt; 0.05), it will be plotted without forcing linearity as for ,“Kisumu” strain in this example.</em></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#To then test the difference in dose-mortality response between the strains</span>
<span class="va">t.models</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/model.signif.html">model.signif</a></span><span class="op">(</span><span class="va">data.b</span><span class="op">)</span>
<span class="va">t.models</span>
<span class="co">#&gt; $model</span>
<span class="co">#&gt;   strain1 strain2           model.pval          deviance df bonferroni</span>
<span class="co">#&gt; 1 Acerkis   AgRR5 9.81944629906017e-18 -93.3705086548187 -2        sig</span>
<span class="co">#&gt; 2 Acerkis  Kisumu 4.09605796743876e-78 -1220.98742604214 -2        sig</span>
<span class="co">#&gt; 3   AgRR5  Kisumu 3.52611879574658e-84 -1433.09904360371 -2        sig</span></code></pre></div>
<p><em>Note that as one of the strains failed the linearity test, the validity of the dose-mortality response test is, at best, highly questionable. We do not recommend it.</em></p>
<p>These steps can be repeated for the different insecticides, either one by one or or in a loop (e.g. “for” loop function).</p>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>3. <strong>REFERENCES</strong>
</h1>
<ol style="list-style-type: decimal">
<li><p>Finney DJ(1971). Probitanalysis. Cambridge:Cambridge UniversityPress. 350p.</p></li>
<li><p>HommelG(1988). A stage wise rejective multiple test procedure based on a modified Bonferroni test. Biometrika 75, 383-6.</p></li>
<li><p>Johnson RM, Dahlgren L, Siegfried BD,EllisMD(2013). Acaricide,fungicide and druginteractions in honeybees (Apis mellifera). PLoSONE8(1): e54092.</p></li>
<li><p>Robertson, J. L., and H.K. Preisler.1992. Pesticide bioassays with arthropods. CRC, Boca Raton, FL.</p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Piyal Karunarathne, Pascal Milesi, Pierrick Labbé.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
